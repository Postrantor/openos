
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>20. File System Abstraction &#8212; Introduction to Operating Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"10d0501df5464d0bbd68e6a036e8a625": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "239803f3fb464495aec1cdf8ad441e30": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_10d0501df5464d0bbd68e6a036e8a625", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ls \n\r: command not found\r\nbash: /home/trantor/.bashrc: line 6: syntax error near unexpected token `$'in\\r''\r\nbash: /home/trantor/.bashrc: line 6: `case $- in\r'\r\ndiskhw.ipynb\t\t      dl_failures.ipynb    interface.ipynb\r\ndisklayout-saved-peter.ipynb  dl_name.ipynb\t   intro.ipynb\r\ndisklayout.ipynb\t      dl_track_free.ipynb  kernelimp.ipynb\r\ndl_blocksize.ipynb\t      dl_track_used.ipynb  review.ipynb\r\ndl_ex_exx.ipynb\t\t      impl.ipynb\r\n$ "}], "tabbable": null, "tooltip": null}}, "3c32eccfb4a54b9b9c881cb11bfaa662": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_91e371ff947b4a98b74dc89fad0e32ca", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ [[ -d mydir ]] && rm -rf mydir\r\ntrantor@P7xxTM1:~$     [[ -a /tmp/foo ]] && rm -rf /tmp/foo\r\ntrantor@P7xxTM1:~$     [[ -a errors ]] && rm errors \r\ntrantor@P7xxTM1:~$     [[ -a mydate ]] && rm mydate\r\ntrantor@P7xxTM1:~$     [[ -a mynewdir ]] && rm -rf mynewdir\r\ntrantor@P7xxTM1:~$     [[ -a anotherfile ]] && rm anotherfile\r\ntrantor@P7xxTM1:~$     [[ -a mybin ]] && rm -rf  mybin\r\ntrantor@P7xxTM1:~$     [[ -a myinfo ]] && rm myinfo\r\ntrantor@P7xxTM1:~$ "}], "tabbable": null, "tooltip": null}}, "40df15481dd142fb997c222aad93a5a0": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d68e98d6e70e43009defe18d284d1f37", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ./fcopy2 README.md rm2\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "43251192d2214cf3b17ffcd5ec16dc5f": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d34d54a677db4f64b3557d50301beee8", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ln -s /bad/file/name bad-link\r\ntrantor@P7xxTM1:~/fslec1$ ls -l bad-link\r\nlrwxrwxrwx 1 trantor trantor 14 Jul 18 12:28 bad-link -> /bad/file/name\r\ntrantor@P7xxTM1:~/fslec1$ cat bad-link\r\ncat: bad-link: No such file or directory\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "510d2891a39e406290c24a3ee4be1b43": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "615f5a0e44f84cffb8ef1efae609a1e0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "75737cc0e84842f69e034ee20eb53a2f": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f3389cb69cbf419fba0d9abc619826d1", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ mount | grep ext4\r\n/dev/sdb on / type ext4 (rw,relatime,discard,errors=remount-ro,data=ordered)\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "83f8197356fc4975ad639031ff84e5ed": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_510d2891a39e406290c24a3ee4be1b43", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ mkdir /tmp/foo; ls -al /tmp/foo; mkdir /tmp/foo/bar ; ls -al /tmp/foo\r\ntotal 8\r\ndrwxr-xr-x 2 trantor trantor 4096 Jul 18 12:28 .\r\ndrwxrwxrwt 4 root    root    4096 Jul 18 12:28 ..\r\ntotal 12\r\ndrwxr-xr-x 3 trantor trantor 4096 Jul 18 12:28 .\r\ndrwxrwxrwt 4 root    root    4096 Jul 18 12:28 ..\r\ndrwxr-xr-x 2 trantor trantor 4096 Jul 18 12:28 bar\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "841e510602ea4e8c944cc3103436e331": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f7e2e49d8c3d43b78c3acc0ce4e95e04", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ln -s loopy loopy\r\ntrantor@P7xxTM1:~/fslec1$ ls -l loopy\r\nlrwxrwxrwx 1 trantor trantor 5 Jul 18 12:28 loopy -> loopy\r\ntrantor@P7xxTM1:~/fslec1$ cat loopy\r\ncat: loopy: Too many levels of symbolic links\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "91e371ff947b4a98b74dc89fad0e32ca": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a39a7c8ad46a4a83b4e4678d9723eac4": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_c76f52e7a4d64ec6957df76231c3d802", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ echo \"Hello class\" >> rm2 ; echo \"diff 2\"; diff README.md rm2\r\ndiff 2\r\n5a6\r\n> Hello class\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}, "c76f52e7a4d64ec6957df76231c3d802": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d34d54a677db4f64b3557d50301beee8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d68e98d6e70e43009defe18d284d1f37": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f3389cb69cbf419fba0d9abc619826d1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f7e2e49d8c3d43b78c3acc0ce4e95e04": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": "1px solid black", "border_left": "1px solid black", "border_right": "1px solid black", "border_top": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fd1df737015c495f839129dcf0e9462d": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_615f5a0e44f84cffb8ef1efae609a1e0", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ echo \"diff 1\" ;  diff README.md rm2\r\ndiff 1\r\ntrantor@P7xxTM1:~/fslec1$ "}], "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fs/interface';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="21. A bit about Disks" href="diskhw.html" />
    <link rel="prev" title="19. Introduction" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro/pref.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Operating Systems - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Operating Systems - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro/pref.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/purpose.html">2. Purpose of operating systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/structure.html">3. Operating System Structure &amp; Unix/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/abstractions.html">4. Operating System Abstractions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/tools.html">5. What you should know</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-c.html">5.1. The C Programming Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-shell.html">5.2. Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-editors.html">5.3. Editors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-make.html">5.4. Make</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-testing.html">5.5. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-git.html">5.6. Git Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-gdb.html">5.7. GDB</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Processor</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scheduling/intro.html">6. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/process.html">7. The Process: A virtual Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/virtual.html">8. Virtualizing the CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/threads.html">9. The Thread: A Virtual CPU</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scheduling/scheduling.html">10. Scheduling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-goals.html">10.1. Scheduling Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-simple.html">10.2. Simple Examples of Scheduling Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-prio.html">10.3. Scheduling with Priorities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-real.html">10.4. Scheduling in the real world</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/review.html">11. Review Questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Memory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mm/intro.html">12. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/phys-and-seg.html">13. Memory management before paged virtual memory</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mm/pagvm.html">14. Paged Virtual memory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mm/vmabs.html">14.1. Abstracting a useful interface for memory management.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/virt-paging.html">14.2. Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/page-tables.html">14.3. Page Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/reclamation.html">14.4. Memory reclaiming algorithms.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/page-size.html">14.5. Page Sizes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/pagefaults.html">14.6. Memory Management Page Faults</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/buffer-cache.html">15. Buffer Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/realworld.html">16. Memory management in the real world</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/concl.html">17. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mm/review.html">18. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">File Systems</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">19. Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">20. File System Abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="diskhw.html">21. A bit about Disks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="impl.html">22. Implementation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="disklayout.html">22.1. File System Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="dl_track_used.html">22.2. Disk Layout:Tracking Used Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="dl_track_free.html">22.3. Disk Layout:Tracking Free Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="dl_name.html">22.4. Disk Layout:Implementing Name Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="dl_failures.html">22.5. Disk Layout:Dealing with Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="dl_ex_exx.html">22.6. Disk Layout:Examples of Real World File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernelimp.html">22.7. Kernel implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">23. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concurrency</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sync/sync.html">24. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sync/basic.html">25. Basic Synchronization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sync/sharing.html">25.1. Cooperating Processes and Inter-process Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/criticalsection.html">25.2. The Critical Section Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/locks.html">25.3. Implementing Locks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/ordering.html">25.4. Ordering Thread Events</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/concurrency_bugs.html">26. Common Concurrency Bugs</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sync/advanced.html">27. Advanced Synchronization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sync/readmostly.html">27.1. Read-Dominated Workloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/hardware_challenges.html">27.2. Challenges of Modern Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/linux_locking.html">27.3. Locking in the Linux Kernel</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/review.html">28. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../devices/devices.html">29. Input and Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devices/disk2.html">30. More on Disks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/virt.html">31. Virtualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec/sec.html">32. Security</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc/howto.html">33. How to read this book</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/intro.html">34. Contributing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/examples.html">34.1. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/credit.html">34.2. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/Contributing.html">34.3. Contributing</a></li>


<li class="toctree-l2"><a class="reference internal" href="../contributing/resources.html">34.6. Resources to look at</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/fix.html">34.7. Out of date</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bib.html">35. Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub-opf-jupyterhub.apps.smaug.na.operate-first.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/OpenOSOrg/openos&urlpath=lab/tree/openos/content/fs/interface.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/edit/main/content/fs/interface.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/issues/new?title=Issue%20on%20page%20%2Ffs/interface.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/fs/interface.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>File System Abstraction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naming">20.1. Naming</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objects">20.2. Objects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#files">20.2.1. Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#directory">20.2.2. Directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-links">20.2.3. Symbolic links</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#file-system-operations">20.3. File System Operations:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-close">20.3.1. Open/close</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#read-write-operations">20.3.1.1. Read/Write operations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming-and-directories">20.3.2. Naming and Directories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#some-examples">20.4. Some examples</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_remove-input tag_hide-output docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="file-system-abstraction">
<span id="cont-fs-interface"></span><h1><span class="section-number">20. </span>File System Abstraction<a class="headerlink" href="#file-system-abstraction" title="Link to this heading">#</a></h1>
<p>From a user perspective, file systems support:</p>
<ul class="simple">
<li><p>a <em>name space</em>, the set of names that identify objects;</p></li>
<li><p><em>objects</em> such as the files themselves as well as directories and other supporting objects;</p></li>
<li><p><em>operations</em> on these objects.</p></li>
</ul>
<p>We first describe how naming works in a Unix file system, then some of the core objects and how they are identified, and then the operations a process can perform on those objects.</p>
<section id="naming">
<h2><span class="section-number">20.1. </span>Naming<a class="headerlink" href="#naming" title="Link to this heading">#</a></h2>
<p>Most file systems today support a
tree-structured namespace<a class="footnote-reference brackets" href="#hier" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, as shown in <a class="reference internal" href="#fs-tree-logical"><span class="std std-numref">Fig. 20.1</span></a>.
This tree is constructed via the use of
<em>directories</em>, or objects in the namespace which map strings to further
file system objects. A full filename thus specifies a <em>path</em> from the
root, through the tree, to the object (a file or directory) itself.
(Hence the use of the term “path” to mean “filename” in Unix
documentation.)</p>
<figure class="align-default" id="fs-tree-logical">
<a class="reference internal image-reference" href="../_images/filesys-tree.png"><img alt="../_images/filesys-tree.png" src="../_images/filesys-tree.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20.1 </span><span class="caption-text">Logical view: hierarchical file system name space</span><a class="headerlink" href="#fs-tree-logical" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Each process has an associated <em>current directory</em>, which may be changed via the <code class="docutils literal notranslate"><span class="pre">chdir</span></code> system call. File names beginning with ‘<code class="docutils literal notranslate"><span class="pre">/</span></code>’ are termed <em>absolute</em> names, and are interpreted relative to the root of the naming tree, while <em>relative</em> names are
interpreted beginning at the current directory. Thus in the file system in
<a class="reference internal" href="#fs-tree-logical"><span class="std std-numref">Fig. 20.1</span></a>, if the current directory were <code class="docutils literal notranslate"><span class="pre">/home</span></code>,
the the paths <code class="docutils literal notranslate"><span class="pre">pjd/.profile</span></code> and <code class="docutils literal notranslate"><span class="pre">/home/pjd/.profile</span></code> refer to the same
file, and <code class="docutils literal notranslate"><span class="pre">../bin/cat</span></code> and <code class="docutils literal notranslate"><span class="pre">/bin/cat</span></code> refer to the same file.</p>
<p>Each directory also contains two special files <code class="docutils literal notranslate"><span class="pre">.</span></code> and <code class="docutils literal notranslate"><span class="pre">..</span></code>, where <code class="docutils literal notranslate"><span class="pre">d/..</span></code>  identifies the parent directory of <code class="docutils literal notranslate"><span class="pre">d</span></code>, and <code class="docutils literal notranslate"><span class="pre">d/.</span></code> identifies <code class="docutils literal notranslate"><span class="pre">d</span></code>
itself.</p>
<p>A typical system may provide access to
several file systems at once, e.g., a local disk and an external USB
drive or network volume. In order to unambiguously specify a file we
thus need to both identify the file within possibly nested directories
in a single file system, as well as identifying the file system itself.
Unix enables a file system to be <em>mounted</em> onto a directory in
another file system, giving a single uniform namespace.  For example, on the systems you are using, there is an <em>ext4</em> file system mounted in the root file system at <code class="docutils literal notranslate"><span class="pre">/opt/app-root/src</span></code>, which you can see if you use the mount command to list all the file systems mounted on this computer.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "75737cc0e84842f69e034ee20eb53a2f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The actual implementation of mounting in Linux and other Unix-like
systems is implemented via a <em>mount table</em>, a small table in the kernel
mapping directories to directories on other file systems. As the
kernel translates a pathname it checks each directory in this table; if
found, it substitutes the mapped file system and directory before
searching for an entry. Thus before searching “/opt/app-root/src” on  for the entry “foo”, the kernel will substitute the
top-level directory on the mounted ext4 files system then search for “foo”.</p>
<p>For a more thorough explanation of path translation in Linux and other
Unix systems see the <code class="docutils literal notranslate"><span class="pre">path_resolution(7)</span></code> man page, i.e. type <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">path_resolution</span></code>.</p>
</section>
<section id="objects">
<h2><span class="section-number">20.2. </span>Objects<a class="headerlink" href="#objects" title="Link to this heading">#</a></h2>
<aside class="sidebar">
<p class="sidebar-title">So, why is it called an inode? Dennis Ritchie, who was one of the authors of UNIX, gave this enlightened answer to the Linux kernel mailing list in 2002:</p>
<blockquote>
<div><p>In truth, I don’t know either. It was just a term that we started to use. “Index” is my best guess, because of the slightly unusual file system structure that stored the access information of files as a flat array on the disk, with all the hierarchical directory information living aside from this. Thus the i-number is an index in this array, the i-node is the selected element of the array.</p>
</div></blockquote>
<p style='text-align: right;'> ---Dennis Ritchie, <a href='https://lkml.indiana.edu/hypermail/linux/kernel/0207.2/1182.html'>[LKML 2002]</a></p>
</aside>
<p>Once you use a pathname to find an object in the file system, you need to find out what kind of an object you have found.  Each file is identified in the file system by a unique <strong>inode number</strong> that references an <strong>inode</strong> data structure that maintains all kinds of information, or <em>meta-data</em> about the file (try <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">inode</span></code> for more information).   While the inode itself is internal to the file system, and contains additional information, generic information can be obtained for any file as described <a class="reference internal" href="#cont-fs-calls-naming"><span class="std std-ref">below</span></a>.  One of the fields in an inode identifies the type of object that the inode refers to. The types of objects that can be referenced by inode are shown in <a class="reference internal" href="#file-types"><span class="std std-numref">Table 20.1</span></a>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="file-types" style="width: 4in">
<caption><span class="caption-number">Table 20.1 </span><span class="caption-text">Types of objects in a file system.</span><a class="headerlink" href="#file-types" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 28.6%" />
<col style="width: 23.8%" />
<col style="width: 47.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>regular file</p></td>
<td><p>S_IFREG</p></td>
<td><p>A regular file normally used to store data</p></td>
</tr>
<tr class="row-odd"><td><p>directory</p></td>
<td><p>S_IFDIR</p></td>
<td><p>A special file used to contain files or other directories</p></td>
</tr>
<tr class="row-even"><td><p>symbolic link</p></td>
<td><p>S_IFLNK</p></td>
<td><p>A kind of “file” that is essentially a pointer to another file name</p></td>
</tr>
<tr class="row-odd"><td><p>block device</p></td>
<td><p>S_IFBLK</p></td>
<td><p>A device that like a disk that is accessed by reading and writing blocks</p></td>
</tr>
<tr class="row-even"><td><p>character device</p></td>
<td><p>S_IFCHR</p></td>
<td><p>A charter device like a <code class="docutils literal notranslate"><span class="pre">tty</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>FIFO</p></td>
<td><p>S_IFIFO</p></td>
<td><p>A pipe</p></td>
</tr>
<tr class="row-even"><td><p>socket</p></td>
<td><p>S_IFSOCK</p></td>
<td><p>A socket used for networking</p></td>
</tr>
</tbody>
</table>
</div>
<p>The last four are special files that you can connect into a file system.  The first three are core objects for all file systems.</p>
<section id="files">
<h3><span class="section-number">20.2.1. </span>Files<a class="headerlink" href="#files" title="Link to this heading">#</a></h3>
<p>In keeping with the idea that everything is a file, Unix made all files just a sequence of 8-bit bytes<a class="footnote-reference brackets" href="#eff" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a><a class="footnote-reference brackets" href="#simple" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. Any
structure to the file (such as a JPEG image, an executable program, or a
database) is the responsibility of applications which read and write the
file. The file format is commonly indicated by a file extension like
.jpg or .xml, but this is just a convention followed by applications and
users. You can do things like rename file.pdf to file.jpg, which will
confuse some applications and users, but it will have no effect on the file
contents.</p>
<p>Data in a byte-sequence file is identified by the combination of the
file and its offset (in bytes) within the file. Unlike in-memory objects
in an application, where a reference (pointer) to a component of an
object may be passed around independently, a portion of a file cannot be
named without identifying the file it is contained in. Data in a file
can be created by a <code class="docutils literal notranslate"><span class="pre">write</span></code> which appends more data to the end of a
shorter file, and modified by over-writing in the middle of a file.
However, it can’t be “moved” from one offset to another: if you use a
text editor to add or delete text in the middle of a file, the editor
must re-write the entire file (or at least from the modified part to the
end).</p>
<figure class="align-default" id="fs-tree-imp">
<a class="reference internal image-reference" href="../_images/filesys-tree2.png"><img alt="../_images/filesys-tree2.png" src="../_images/filesys-tree2.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20.2 </span><span class="caption-text">Implementation view: hierarchical file system name space. Gray blocks are directories that contain entries with strings and corresponding inode numbers that identify the files.</span><a class="headerlink" href="#fs-tree-imp" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="directory">
<span id="cont-fs-interface-dir"></span><h3><span class="section-number">20.2.2. </span>Directory<a class="headerlink" href="#directory" title="Link to this heading">#</a></h3>
<p>As shown in <a class="reference internal" href="#fs-tree-imp"><span class="std std-numref">Fig. 20.2</span></a>, a directory contains entries with strings that identify objects contained in the directory, and for each the inode numbers that can then be used to find out more information about the corresponding object.   The same inode can be referenced by multiple directories, with potentially different names. Each directory entry that maps a name to an inode number is called a <em>hard link</em> to the inode, and another field in the inode structure records the number of hard links to that inode.  For example, the entry named <code class="docutils literal notranslate"><span class="pre">..</span></code> in any directory is a hard link to the parent directory. To illustrate this point, let’s create a directory named <code class="docutils literal notranslate"><span class="pre">foo</span></code> in the <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> directory and see how the link count for <code class="docutils literal notranslate"><span class="pre">foo</span></code> changes when we create a subdirectory <code class="docutils literal notranslate"><span class="pre">bar</span></code> inside foo.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "83f8197356fc4975ad639031ff84e5ed", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>As we can see, after creating a directory <code class="docutils literal notranslate"><span class="pre">/tmp/foo</span></code> the reference count (second entry in the output above) for the <code class="docutils literal notranslate"><span class="pre">.</span></code> in <code class="docutils literal notranslate"><span class="pre">foo</span></code> is 2 before we create a subdirectory  <code class="docutils literal notranslate"><span class="pre">bar</span></code> in it, and 3 after. The initial two links come from the parent directory’s entry named <code class="docutils literal notranslate"><span class="pre">foo</span></code>, and the <code class="docutils literal notranslate"><span class="pre">.</span></code> entry in <code class="docutils literal notranslate"><span class="pre">foo</span></code> itself. After the creation of <code class="docutils literal notranslate"><span class="pre">bar</span></code>, there is a third link to the inode for <code class="docutils literal notranslate"><span class="pre">foo</span></code> due to the <code class="docutils literal notranslate"><span class="pre">..</span></code> entry in <code class="docutils literal notranslate"><span class="pre">bar</span></code>, which refers to its parent directory.</p>
<p>The link count in an inode ensures that the object the inode refers to (file or directory) will not be deleted as long as there is at least one hard link to the inode. When you issue a delete command for a filename (e.g., ‘rm somefile’), the file system removes the entry for the filename from a directory and decrements the link count on the inode that entry referred to. Only when the last hard link is removed will the file object really be freed.</p>
</section>
<section id="symbolic-links">
<h3><span class="section-number">20.2.3. </span>Symbolic links<a class="headerlink" href="#symbolic-links" title="Link to this heading">#</a></h3>
<p>The third file system object is a
<em>symbolic link</em>. This holds a text string which is interpreted as a
“pointer” to another location in the file system. When the kernel is
searching for a file and encounters a symbolic link, it substitutes this
text into the current portion of the path, and continues the translation
process.</p>
<p>This can be very useful</p>
<pre>
directory: /usr/program-1.0.1
  file:      /usr/program-1.0.1/file.txt
  sym link:  /usr/program-current -> "program-1.0.1"
</pre>
<p>and if the OS is looking up the file <code class="docutils literal notranslate"><span class="pre">/usr/program-current/file.txt</span></code>, it
will:</p>
<ol class="arabic simple">
<li><p>look up <code class="docutils literal notranslate"><span class="pre">usr</span></code> in the root directory, finding a pointer to the <code class="docutils literal notranslate"><span class="pre">/usr</span></code>
directory</p></li>
<li><p>look up <code class="docutils literal notranslate"><span class="pre">program-current</span></code> in <code class="docutils literal notranslate"><span class="pre">/usr</span></code>, finding the link with contents
<code class="docutils literal notranslate"><span class="pre">program-1.0.1</span></code></p></li>
<li><p>look up <code class="docutils literal notranslate"><span class="pre">program-1.0.1</span></code> and use this result instead of the result from
looking up <code class="docutils literal notranslate"><span class="pre">program-current</span></code>, getting a pointer to the
<code class="docutils literal notranslate"><span class="pre">/usr/program-1.0.1</span></code> directory.</p></li>
<li><p>look up <code class="docutils literal notranslate"><span class="pre">file.txt</span></code> in this directory, and find it.</p></li>
</ol>
<p>Note that unlike hard links, a symbolic link does not increase the link count in the inode that it refers to. As a result, a symbolic link may be “broken”—i.e., if
the file it points to does not exist. This can happen if the link was
created in error, or the file or directory it points to is deleted
later. In that case path translation will fail with an error:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "43251192d2214cf3b17ffcd5ec16dc5f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Finally, to prevent loops there is a limit on how many levels of
symbolic link may be traversed in a single path translation:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "841e510602ea4e8c944cc3103436e331", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="file-system-operations">
<h2><span class="section-number">20.3. </span>File System Operations:<a class="headerlink" href="#file-system-operations" title="Link to this heading">#</a></h2>
<p>There are several common types of file operations supported by Linux
(and with slight differences, Windows). They can be classified into
three main categories: open/close, read/write, and naming and
directories.</p>
<section id="open-close">
<h3><span class="section-number">20.3.1. </span>Open/close<a class="headerlink" href="#open-close" title="Link to this heading">#</a></h3>
<p>In order to access a file in Linux (or most operating
systems) you first need to open the file, passing the file name and
other parameters and receiving a <em>handle</em> (called a <em>file descriptor</em> in
Unix) which may be used for further operations. The corresponding system
calls are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">desc</span> <span class="pre">=</span> <span class="pre">open(name,</span> <span class="pre">O_READ)</span></code>: Verify that file <code class="docutils literal notranslate"><span class="pre">name</span></code> exists and may
be read, and then return a <em>descriptor</em> which may be used to refer to
that file when reading it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">desc</span> <span class="pre">=</span> <span class="pre">open(name,</span> <span class="pre">O_WRITE</span> <span class="pre">|</span> <span class="pre">flags,</span> <span class="pre">mode)</span></code>: Verify permissions and
open <code class="docutils literal notranslate"><span class="pre">name</span></code> for writing, creating it (or erasing existing contents) if
necessary as specified in <code class="docutils literal notranslate"><span class="pre">flags</span></code>. Returns a descriptor which may be
used for writing to that file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">close(desc)</span></code>: stop using this descriptor, and free any resources
allocated for it.</p></li>
</ul>
<p>Note that application programs rarely use the system calls themselves to
access files, but instead use higher-level frameworks, ranging from Unix
Standard I/O to high-level application frameworks.</p>
<section id="read-write-operations">
<span id="cont-fs-interface-operations"></span><h4><span class="section-number">20.3.1.1. </span>Read/Write operations<a class="headerlink" href="#read-write-operations" title="Link to this heading">#</a></h4>
<p>To get a file with data in it, you need to write it; to use that data you need to read it. To enable files to be accessed as a <em>stream</em> just like from a terminal or pipe, UNIX uses the concept of a <em>current position</em>
associated with a file descriptor. When you read 100 bytes (i.e. bytes 0
to 99) from a file, this pointer advances by 100 bytes, so that the next
read will start at byte 100, and similarly for write. When a file is
opened for reading the pointer starts at 0; when open for writing the
application writer can choose to start at the beginning (default) and
overwrite old data, or start at the end (<code class="docutils literal notranslate"><span class="pre">O_APPEND</span></code> flag) to append new
data to the file.</p>
<p>The read and write routines are the same ones we described before, but, for ease of reference, they are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">read(desc,</span> <span class="pre">buffer,</span> <span class="pre">max)</span></code>: Read <code class="docutils literal notranslate"><span class="pre">max</span></code> bytes (or fewer if the end of
the file is reached) into <code class="docutils literal notranslate"><span class="pre">buffer</span></code>, starting at the current position,
and returning the actual number of bytes <code class="docutils literal notranslate"><span class="pre">n</span></code> read; the current position
is then incremented by <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">write(desc,</span> <span class="pre">buffer,</span> <span class="pre">len)</span></code>: Write <code class="docutils literal notranslate"><span class="pre">len</span></code> bytes from <code class="docutils literal notranslate"><span class="pre">buffer</span></code> into
the file, starting at the current position, and incrementing the current
position by <code class="docutils literal notranslate"><span class="pre">len</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lseek(desc,</span> <span class="pre">offset,</span> <span class="pre">flag)</span></code>: Set an open file’s current position to that
specified by <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">flag</span></code>, which specifies whether <code class="docutils literal notranslate"><span class="pre">offset</span></code> is
relative to the beginning, end, or current position in the file.</p></li>
</ul>
<p>Note that in the basic Unix interface (unlike e.g. Windows) there is no
way to specify a particular location in a file to read or write
from<a class="footnote-reference brackets" href="#pread" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>. Programs like databases (e.g. SQLite, MySQL) which need to
write to and read from arbitrary file locations must instead move the
current position by using <code class="docutils literal notranslate"><span class="pre">lseek</span></code> before a read or write. However, most
programs either read or write a file from the beginning to the end
(especially when written for an OS that makes it easier to do things
that way), and thus don’t really need to perform seeks. Because most
Unix programs use simple “stream” input and output, these may be
re-directed so that the same program can—without any special
programming—read from or write to a terminal, a network connection, a
file, or a pipe from or to another program.</p>
</section>
</section>
<section id="naming-and-directories">
<span id="cont-fs-calls-naming"></span><h3><span class="section-number">20.3.2. </span>Naming and Directories<a class="headerlink" href="#naming-and-directories" title="Link to this heading">#</a></h3>
<p>In Unix there is a difference between a name
(a directory entry) and the object (file or directory) that the name
points to. The naming and directories operations are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rename(path1,</span> <span class="pre">path2)</span></code> - Rename an object (i.e., a file or directory) by
either changing the name in its directory entry (if the destination is
in the same directory) or creating a new entry and deleting the old one
(if moving into a new directory).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">link(path1,</span> <span class="pre">path2)</span></code>: Add a <em>hard link</em> to a file<a class="footnote-reference brackets" href="#hardlink" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unlink(path)</span></code>: Decrement the reference count to a file, if it goes to zero, delete the file<a class="footnote-reference brackets" href="#unlink" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">desc</span> <span class="pre">=</span> <span class="pre">opendir(path)</span></code>, <code class="docutils literal notranslate"><span class="pre">readdir(desc,</span> <span class="pre">dirent*),</span> <span class="pre">dirent=(name,type,length)</span></code>: This interface allows a program to enumerate names in a directory, and determine their type (i.e., file, directory, symbolic link, or special-purpose file).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stat(file,</span> <span class="pre">statbuf)</span></code>, <code class="docutils literal notranslate"><span class="pre">fstat(desc,</span> <span class="pre">statbuf)</span></code>:  returns information about the file such as  size, owner, permissions, modification time, etc. These are attributes of the file itself, residing in the inode and returned in the following structure.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">stat</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">dev_t</span><span class="w">     </span><span class="n">st_dev</span><span class="p">;</span><span class="w">         </span><span class="cm">/* ID of device containing file */</span>
<span class="w">  </span><span class="kt">ino_t</span><span class="w">     </span><span class="n">st_ino</span><span class="p">;</span><span class="w">         </span><span class="cm">/* Inode number */</span>
<span class="w">  </span><span class="kt">mode_t</span><span class="w">    </span><span class="n">st_mode</span><span class="p">;</span><span class="w">        </span><span class="cm">/* File type and mode */</span>
<span class="w">  </span><span class="n">nlink_t</span><span class="w">   </span><span class="n">st_nlink</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Number of hard links */</span>
<span class="w">  </span><span class="kt">uid_t</span><span class="w">     </span><span class="n">st_uid</span><span class="p">;</span><span class="w">         </span><span class="cm">/* User ID of owner */</span>
<span class="w">  </span><span class="kt">gid_t</span><span class="w">     </span><span class="n">st_gid</span><span class="p">;</span><span class="w">         </span><span class="cm">/* Group ID of owner */</span>
<span class="w">  </span><span class="kt">dev_t</span><span class="w">     </span><span class="n">st_rdev</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Device ID (if special file) */</span>
<span class="w">  </span><span class="kt">off_t</span><span class="w">     </span><span class="n">st_size</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Total size, in bytes */</span>
<span class="w">  </span><span class="n">blksize_t</span><span class="w"> </span><span class="n">st_blksize</span><span class="p">;</span><span class="w">     </span><span class="cm">/* Block size for filesystem I/O */</span>
<span class="w">  </span><span class="n">blkcnt_t</span><span class="w">  </span><span class="n">st_blocks</span><span class="p">;</span><span class="w">      </span><span class="cm">/* Number of 512B blocks allocated */</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">timespec</span><span class="w"> </span><span class="n">st_atim</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Time of last access */</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">timespec</span><span class="w"> </span><span class="n">st_mtim</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Time of last modification */</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">timespec</span><span class="w"> </span><span class="n">st_ctim</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Time of last status change */</span>
<span class="p">};</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mkdir(path)</span></code>, <code class="docutils literal notranslate"><span class="pre">rmdir(path)</span></code>: directory operations: create a new, empty directory, or delete an empty directory.</p></li>
</ul>
</section>
</section>
<section id="some-examples">
<h2><span class="section-number">20.4. </span>Some examples<a class="headerlink" href="#some-examples" title="Link to this heading">#</a></h2>
<p>Consider the following program in <a class="reference internal" href="#filecopy-listing"><span class="std std-numref">Listing 20.1</span></a>, which copies one file to another.  After opening the input file (line 26) we stat the input file to get the permissions (i.e., the mode), create a file with that mode (line 37), and then go into a loop reading data from the input file into a buffer, and then writing the buffer to the output file.</p>
<div class="literal-block-wrapper docutils container" id="filecopy-listing">
<div class="code-block-caption"><span class="caption-number">Listing 20.1 </span><span class="caption-text">fcopy2.c - An example program that copies one file to another using the file system interface.</span><a class="headerlink" href="#filecopy-listing" title="Link to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">//</span> <span class="n">simple</span> <span class="n">program</span> <span class="n">to</span> <span class="n">copy</span> <span class="n">a</span> <span class="n">file</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1">#include &lt;sys/types.h&gt;</span>
<span class="linenos"> 4</span><span class="c1">#include &lt;fcntl.h&gt;</span>
<span class="linenos"> 5</span><span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="linenos"> 6</span><span class="c1">#include &lt;unistd.h&gt;</span>
<span class="linenos"> 7</span><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="linenos"> 8</span><span class="c1">#include &lt;assert.h&gt;</span>
<span class="linenos"> 9</span><span class="c1">#include &lt;sys/stat.h&gt;</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1">#define BUF_SIZE 4096</span>
<span class="linenos">12</span><span class="o">//</span> <span class="n">user</span> <span class="n">has</span> <span class="n">read</span> <span class="ow">and</span> <span class="n">write</span> <span class="n">permission</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="linenos">15</span><span class="p">{</span>
<span class="linenos">16</span>	<span class="nb">int</span> <span class="n">in_fd</span><span class="p">,</span> <span class="n">out_fd</span><span class="p">,</span> <span class="n">rd_count</span><span class="p">,</span> <span class="n">wt_count</span><span class="p">,</span> <span class="n">rc</span><span class="p">;</span>
<span class="linenos">17</span>	<span class="n">mode_t</span> <span class="n">md</span><span class="p">;</span> 
<span class="linenos">18</span>	<span class="n">struct</span> <span class="n">stat</span> <span class="n">statbuf</span><span class="p">;</span>	
<span class="linenos">19</span>	<span class="n">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">BUF_SIZE</span><span class="p">];</span>
<span class="linenos">20</span>
<span class="linenos">21</span>	<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">22</span>		<span class="n">perror</span><span class="p">(</span><span class="s2">&quot;Can&#39;t open input file</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="linenos">23</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">24</span>	<span class="p">}</span>
<span class="linenos">25</span>
<span class="hll"><span class="linenos">26</span>	<span class="n">in_fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">);</span>
</span><span class="linenos">27</span>	<span class="k">if</span> <span class="p">(</span><span class="n">in_fd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">28</span>		<span class="n">perror</span><span class="p">(</span><span class="s2">&quot;Can&#39;t creat output file</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="linenos">29</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">30</span>	<span class="p">}</span>
<span class="linenos">31</span>	<span class="k">if</span> <span class="p">((</span><span class="n">rc</span> <span class="o">=</span> <span class="n">fstat</span><span class="p">(</span><span class="n">in_fd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">statbuf</span><span class="p">))</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">32</span>		<span class="n">perror</span><span class="p">(</span><span class="s2">&quot;fstat failed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="linenos">33</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">34</span>	<span class="p">}</span>
<span class="linenos">35</span>	<span class="n">md</span> <span class="o">=</span> <span class="n">statbuf</span><span class="o">.</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">S_IRWXU</span><span class="o">|</span><span class="n">S_IRWXG</span><span class="o">|</span><span class="n">S_IRWXO</span><span class="p">);</span>
<span class="linenos">36</span>
<span class="hll"><span class="linenos">37</span>	<span class="n">out_fd</span> <span class="o">=</span> <span class="n">creat</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">md</span><span class="p">);</span>
</span><span class="linenos">38</span>	<span class="k">if</span> <span class="p">(</span><span class="n">out_fd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos">39</span>		<span class="n">perror</span><span class="p">(</span><span class="s2">&quot;Can&#39;t creat output file</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="linenos">40</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">41</span>	<span class="p">}</span>
<span class="linenos">42</span>
<span class="hll"><span class="linenos">43</span>	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll"><span class="linenos">44</span>		<span class="n">rd_count</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">in_fd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">BUF_SIZE</span><span class="p">);</span>
</span><span class="linenos">45</span>		<span class="k">if</span> <span class="p">(</span><span class="n">rd_count</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="o">//</span> <span class="n">done</span>
<span class="linenos">46</span>			<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">47</span>		<span class="p">}</span>
<span class="linenos">48</span>		<span class="k">assert</span><span class="p">(</span><span class="n">rd_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
<span class="linenos">49</span>
<span class="linenos">50</span>			
<span class="hll"><span class="linenos">51</span>		<span class="n">wt_count</span> <span class="o">=</span> <span class="n">write</span><span class="p">(</span><span class="n">out_fd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">rd_count</span><span class="p">);</span>
</span><span class="linenos">52</span>		<span class="k">assert</span><span class="p">(</span><span class="n">wt_count</span> <span class="o">==</span> <span class="n">rd_count</span><span class="p">);</span>
<span class="linenos">53</span>	<span class="p">}</span>
<span class="linenos">54</span>	<span class="n">close</span><span class="p">(</span><span class="n">in_fd</span><span class="p">);</span>
<span class="linenos">55</span>	<span class="n">close</span><span class="p">(</span><span class="n">out_fd</span><span class="p">);</span>
<span class="linenos">56</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "40df15481dd142fb997c222aad93a5a0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>To prove these are the same, let’s first use the <code class="docutils literal notranslate"><span class="pre">diff</span></code> program to compare them:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fd1df737015c495f839129dcf0e9462d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>We can see that there is no difference between the files, since <code class="docutils literal notranslate"><span class="pre">diff</span></code> produces no output. But just to be sure, let’s append a string to the end of the copy (i.e., echo “Hello class” &gt;&gt; rm2) and use the <code class="docutils literal notranslate"><span class="pre">diff</span></code> program to compare them again.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a39a7c8ad46a4a83b4e4678d9723eac4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>And here we see that the only difference is the line we just appended to the copy of the original <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file.</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="hier" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Very early file systems sometimes had a single flat directory per user, or like MS-DOS 1.0, a single directory per floppy disk</p>
</aside>
<aside class="footnote brackets" id="eff" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>it is probably not a
coincidence that Unix arrived at the same time as computers which dealt
only with multiples of 8-bit bytes (e.g. 16 and 32-bit words), replacing
older systems which frequently used odd word sizes such as 36 bits.
(Note that a machine with 36-bit instructions already needs two
incompatible types of files, one for text and one for executable code.)</p>
</aside>
<aside class="footnote brackets" id="simple" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>This is the case for almost all operating systems today, but… of course there are exceptions.  Apple OSX uses resource forks to store information associated with a file (HFS and HFS+ file systems only), Windows NTFS provides for multiple data streams in single file, although they were never put to use, and several file systems support file attributes, which are small tags associated with a file.</p>
</aside>
<aside class="footnote brackets" id="pread" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>On Linux the <code class="docutils literal notranslate"><span class="pre">pread</span></code> and <code class="docutils literal notranslate"><span class="pre">pwrite</span></code> system calls allow specifying an
offset for the read or write; other UNIX-derived operating systems
have their own extensions for this purpose.</p>
</aside>
<aside class="footnote brackets" id="hardlink" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>A hard link is an additional directory entry pointing to the same
file, giving the file two (or more) names. Hard links are peculiar
to Unix, and in modern systems have mostly been replaced with
symbolic links (covered above); however Apple’s Time Machine makes
very good use of them: multiple backups can point to the same single
copy of an un-modified file using hard links.</p>
</aside>
<aside class="footnote brackets" id="unlink" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>Even when the reference count goes to zero, the file might not be removed yet - on Unix, if you
delete an open file it won’t actually be removed until all open file
handles are closed.. In general, deleting open files is a problem:
while Unix solves the problem by deferring the actual delete,
Windows solves it by protecting open files so that they cannot be
deleted.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./fs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">19. </span>Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="diskhw.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">21. </span>A bit about Disks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naming">20.1. Naming</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objects">20.2. Objects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#files">20.2.1. Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#directory">20.2.2. Directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-links">20.2.3. Symbolic links</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#file-system-operations">20.3. File System Operations:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-close">20.3.1. Open/close</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#read-write-operations">20.3.1.1. Read/Write operations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming-and-directories">20.3.2. Naming and Directories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#some-examples">20.4. Some examples</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By (see contributing chapter book)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>