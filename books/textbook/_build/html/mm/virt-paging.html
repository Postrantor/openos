
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>14.2. Paging &#8212; Introduction to Operating Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mm/virt-paging';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="14.3. Page Tables" href="page-tables.html" />
    <link rel="prev" title="14.1. Abstracting a useful interface for memory management." href="vmabs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro/pref.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction to Operating Systems - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction to Operating Systems - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro/pref.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/purpose.html">2. Purpose of operating systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/structure.html">3. Operating System Structure &amp; Unix/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/abstractions.html">4. Operating System Abstractions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/tools.html">5. What you should know</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-c.html">5.1. The C Programming Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-shell.html">5.2. Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-editors.html">5.3. Editors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-make.html">5.4. Make</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-testing.html">5.5. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-git.html">5.6. Git Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tools-gdb.html">5.7. GDB</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Processor</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scheduling/intro.html">6. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/process.html">7. The Process: A virtual Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/virtual.html">8. Virtualizing the CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/threads.html">9. The Thread: A Virtual CPU</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../scheduling/scheduling.html">10. Scheduling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-goals.html">10.1. Scheduling Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-simple.html">10.2. Simple Examples of Scheduling Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-prio.html">10.3. Scheduling with Priorities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduling/sch-real.html">10.4. Scheduling in the real world</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduling/review.html">11. Review Questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Virtual Memory</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">12. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="phys-and-seg.html">13. Memory management before paged virtual memory</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="pagvm.html">14. Paged Virtual memory</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vmabs.html">14.1. Abstracting a useful interface for memory management.</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">14.2. Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="page-tables.html">14.3. Page Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="reclamation.html">14.4. Memory reclaiming algorithms.</a></li>
<li class="toctree-l2"><a class="reference internal" href="page-size.html">14.5. Page Sizes</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagefaults.html">14.6. Memory Management Page Faults</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="buffer-cache.html">15. Buffer Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="realworld.html">16. Memory management in the real world</a></li>
<li class="toctree-l1"><a class="reference internal" href="concl.html">17. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">18. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">File Systems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fs/intro.html">19. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/interface.html">20. File System Abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/diskhw.html">21. A bit about Disks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fs/impl.html">22. Implementation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../fs/disklayout.html">22.1. File System Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/dl_track_used.html">22.2. Disk Layout:Tracking Used Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/dl_track_free.html">22.3. Disk Layout:Tracking Free Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/dl_name.html">22.4. Disk Layout:Implementing Name Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/dl_failures.html">22.5. Disk Layout:Dealing with Failures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/dl_ex_exx.html">22.6. Disk Layout:Examples of Real World File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fs/kernelimp.html">22.7. Kernel implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/review.html">23. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concurrency</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sync/sync.html">24. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sync/basic.html">25. Basic Synchronization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sync/sharing.html">25.1. Cooperating Processes and Inter-process Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/criticalsection.html">25.2. The Critical Section Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/locks.html">25.3. Implementing Locks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/ordering.html">25.4. Ordering Thread Events</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/concurrency_bugs.html">26. Common Concurrency Bugs</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sync/advanced.html">27. Advanced Synchronization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sync/readmostly.html">27.1. Read-Dominated Workloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/hardware_challenges.html">27.2. Challenges of Modern Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sync/linux_locking.html">27.3. Locking in the Linux Kernel</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../sync/review.html">28. Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../devices/devices.html">29. Input and Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devices/disk2.html">30. More on Disks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/virt.html">31. Virtualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec/sec.html">32. Security</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc/howto.html">33. How to read this book</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/intro.html">34. Contributing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/examples.html">34.1. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/credit.html">34.2. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/Contributing.html">34.3. Contributing</a></li>


<li class="toctree-l2"><a class="reference internal" href="../contributing/resources.html">34.6. Resources to look at</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/fix.html">34.7. Out of date</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bib.html">35. Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub-opf-jupyterhub.apps.smaug.na.operate-first.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/OpenOSOrg/openos&urlpath=lab/tree/openos/content/mm/virt-paging.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/edit/main/content/mm/virt-paging.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenOSOrg/openos/issues/new?title=Issue%20on%20page%20%2Fmm/virt-paging.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/mm/virt-paging.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Paging</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paged-address-translation">14.2.1. Paged Address Translation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-virtual-address-space-with-paging">14.2.1.1. The virtual address space with Paging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mmu-memory-management-unit">14.2.2. MMU Memory Management Unit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-over-commitment-and-paging">14.2.2.1. Memory Over-Commitment and Paging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paging-avoiding-fragmentation">14.2.3. Paging - Avoiding Fragmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-fragmentation">14.2.3.1. Internal Fragmentation</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p id="cont-mm-virt-paging">This chapter describes a pages virtual memory system works, what the MMU is and how it works
and how we over commit physical memory using it.</p>
<section class="tex2jax_ignore mathjax_ignore" id="paging">
<h1><span class="section-number">14.2. </span>Paging<a class="headerlink" href="#paging" title="Link to this heading">#</a></h1>
<section id="paged-address-translation">
<h2><span class="section-number">14.2.1. </span>Paged Address Translation<a class="headerlink" href="#paged-address-translation" title="Link to this heading">#</a></h2>
<p>Most virtual memory systems today use a paged address translation AKA paging.  A paged virtual memory system divides both virtual memory and physical memory into relatively small fixed size chunks pieces.  They are known as virtual pages or just pages in the virtual address space and page frames in the physical memory space.  The memory management system maintains a mapping for each virtual page in use to a page frame that contains the actual memory contents.</p>
<figure class="align-default" id="paged-memory">
<a class="reference internal image-reference" href="../_images/pagedmem.png"><img alt="../_images/pagedmem.png" src="../_images/pagedmem.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.1 </span><span class="caption-text">Paged virtual memory example</span><a class="headerlink" href="#paged-memory" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Paging solves a couple major problems that segmentation has: 1.) The paged virtual address space can be much larger than physical memory. 2.) Paging eliminates the need to maintain large regions of physically contiguous memory.</p>
<p>In the segmentation memory model its not possible to run a program that’s requires more physical memory than the system has.  This means a program may run on a system with a large amount of memory and not be able to run on a system with a smaller amount of memory at all.</p>
<p>Another benefit of paging over segmentation is that a region of virtual memory does not need to map physically contiguous memory.  Since the virtual address space is divided into small fixed size pages a virtually contiguous region of memory can map several page frames that are randomly scattered throughout the entire physical memory.</p>
<section id="the-virtual-address-space-with-paging">
<h3><span class="section-number">14.2.1.1. </span>The virtual address space with Paging<a class="headerlink" href="#the-virtual-address-space-with-paging" title="Link to this heading">#</a></h3>
<p>On a paged virtual memory system every process has exactly the same size virtual address space, gigabytes, terabytes or even petabytes on modern systems is typical.  By default none of the virtual pages within this huge address space is valid when a process and it’s associated virtual address space is created and therefore can not be referenced.  In order to make regions of the virtual address space valid either part of a file must be mapped into a virtual region or virtual memory must be dynamically allocated creating a virtual region.  Since the virtual regions are relatively small the huge virtual address space is sparsely populated with small valid virtual regions.  As we discussed earlier in this book a process and its associated virtual address space is created when a child process is created via fork().  At this time the valid virtual regions are duplicated from the parent process to the child process.  The regions within the virtual address space can also be eliminated and new ones created when the process runs a different program via exec().</p>
<p>When the virtual regions are initially created or the virtual address is changed no page frames are mapped into the virtual pages within them, however a program can legally access pages within the virtual regions.  When this happens the memory management system responds by mapping a physical page into each virtual page as it is accessed or on demand.  This means the virtual regions are sparsely populated with physical memory pages, similar to the way the entire virtual address space is sparsely populated with valid virtual regions.  As a process runs on a paged virtual memory system only a small subset of physical page frames are required to be mapped into virtual memory pages at a given time.</p>
<p>The paged virtual memory management system is responsible for multiplexing the page frames and insuring that at least the necessary virtual to physical mappings are in place.  On systems with larger amounts of physical memory more page frames can be mapped into virtual pages than systems with smaller amounts of physical memory.
This means a program running on a small memory system probably just runs slower than on systems with large amounts rather than not being able to run at all.  This is a huge improvement over segmented systems where some programs can not run at all on systems without adequate memory.</p>
<p>Another benefit of paging over segmentation is that a region of virtual memory does not need to map physically contiguous page frames.  Since the virtual address space is divided into small fixed size pages a virtually contiguous region can map page frames that are randomly scattered throughout the entire physical memory.  This eliminates the need to maintain physically contiguous memory, an overhead that is both complex and very CPU intensive.  In addition, it completely eliminates external fragmentation, further eliminating the need to perform compaction.  The only fragmentation issue encountered in a page virtual memory system is internal fragmentation.  An internal fragment is the unused portion of a page at the end of a region of virtual memory.  An internal fragment which is only half of one page on the average is typically much smaller than the external fragment associated with segmentation can not be reclaimed by the memory management system.</p>
</section>
</section>
<section id="mmu-memory-management-unit">
<h2><span class="section-number">14.2.2. </span>MMU Memory Management Unit<a class="headerlink" href="#mmu-memory-management-unit" title="Link to this heading">#</a></h2>
<p>Every time a virtual address is referenced it must be translated to a physical address before presenting it to the memory address bus hardware.  This would be unacceptably slow so on paged systems the CPU includes special hardware that maintains the virtual to physical page mappings for each page.  This CPU hardware is known as the Memory Management Unit or MMU.</p>
<p>We examine a single model of address translation in detail: the one used
by the original Pentium, and by any Intel-compatible CPU running in
32-bit mode. It uses 32-bit virtual addresses, 32-bit physical
addresses, and a page size of 4096 bytes. Since pages are <span class="math notranslate nohighlight">\(2^{12}\)</span> bytes
each, addresses can be divided into 20-bit page numbers and 12-bit
offsets within each page, as shown in <a class="reference internal" href="#fig-vm-fig5"><span class="std std-numref">Fig. 14.3</span></a>.</p>
<figure class="align-default" id="fig-vm-fig6">
<a class="reference internal image-reference" href="../_images/virt-mem-pic10.png"><img alt="../_images/virt-mem-pic10.png" src="../_images/virt-mem-pic10.png" style="height: 5.5cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.2 </span><span class="caption-text">Example of virtual address mapping to physical address</span><a class="headerlink" href="#fig-vm-fig6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The Memory Management Unit (MMU) maps a 20-bit virtual page number to a
20-bit physical page number; the offset can pass through unchanged, as
shown in <a class="reference internal" href="#fig-vm-fig6"><span class="std std-numref">Fig. 14.2</span></a>, giving the physical address the CPU should
access.</p>
<figure class="align-default" id="fig-vm-fig5">
<a class="reference internal image-reference" href="../_images/virt-mem-pic9.png"><img alt="../_images/virt-mem-pic9.png" src="../_images/virt-mem-pic9.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.3 </span><span class="caption-text">Page number and offset in 32-bit paged translation with 4KB pages</span><a class="headerlink" href="#fig-vm-fig5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Although paged address translation is far more flexible than base and
bounds registers found in segmentation, it requires much more information.
Base and bounds translation only requires two values, which can easily be held in
registers in the MMU. In contrast, paged translation must be able to
handle a separate mapping value for each of thousands or even million virtual
pages(although most programs will only map a fraction of those pages).
The only possible place to store the amount of information required by
paged address translation is in tables located in memory itself.  These
memory resident tables of virtual to physical translations are known as
page tables.  The MMU uses the in-memory page tables or mappings to translate
from every virtual address to the actual physical addresses.</p>
<section id="memory-over-commitment-and-paging">
<h3><span class="section-number">14.2.2.1. </span>Memory Over-Commitment and Paging<a class="headerlink" href="#memory-over-commitment-and-paging" title="Link to this heading">#</a></h3>
<p>Page faults allow data to be dynamically fetched into memory when it is
needed, in the same way that the CPU dynamically fetches data from
memory into the cache. This allows the operating system to over-commit
memory: the sum of all process address spaces can add up to more memory
than is available, although the total amount of memory mapped at any
point in time must fit into RAM. This means that when a page fault
occurs and a page is allocated to a process, another page (from that or
another process) may need to be evicted from memory.</p>
<p>There are two types of regions in a user a user’s virtual address space:
file-backed and anonymous.</p>
<p>File-backed regions are contiguous portions of a file on storage that is mapped into a user’s virtual address space.  For example the exec()system call mmap()’s the text and data section of an executable file into a users address space at predetermined virtual addresses.  The majority of the page frames mapped into file backed regions are read-only mappings and therefore are never modified so never need to be flushed or written back to storage.  When a process exits and munmap()s its file-backed regions nothing is deleted.  Everything is from some file that exist on some storage device.</p>
<p>Anonymous memory regions do not correspond to a file.  Instead, they are the data, heap and stack regions of the user’s virtual address space.  Unlike file-backed regions the page frames mapped into anonymous regions are almost always modified.  Consider what would be the sense of allocating from a heap and only reading from it?
For this reason all page frames mapped into anonymous regions must be written to some storage location if it is to be reclaimed.  Also unlike file-backed regions all the page frames mapped into anonymous regions are deleted and therefor immediately freed. The data, heap and stack contents of a process that is exiting is on no value to any other process and therefor can be eliminated</p>
<p>Evicting a read-only page mapped from a file is simple: just forget the
mapping and free the page; if a fault for that page occurs later, the
page can be read back from disk. Occasionally pages are mapped
read/write from a file, when a program explicitly requests it with
<code class="docutils literal notranslate"><span class="pre">mmap</span></code>—in that case the OS can write any modified data back to the
file and then evict the page; again it can be paged back from disk if
needed again.</p>
<p>Anonymous segments such as stack and heap are typically created in
memory and do not need to be swapped; however if the system runs low on
memory it may evict anonymous pages owned by idle processes, in order to
give more memory to the currently-running ones. To do this the OS
allocates a location in “swap space” on disk: typically a dedicated swap
partition in Linux, and the <code class="docutils literal notranslate"><span class="pre">PAGEFILE.sys</span></code> and <code class="docutils literal notranslate"><span class="pre">/var/vm/swapfile</span></code> files
in Windows and OSX respectively. The data must first be written out to
that location, then the OS can store the page-to-location mapping and
release the memory page.</p>
<p>Hint: Linux uses/borrows the page table entry to store the location of
a swapped out page.<br />
As long as the PTE present bit is not set the MMU hardware
will not attempt to translate, instead it will cause a page fault.
The entire PTE can be used by software when the present bit is not set.</p>
<figure class="align-default" id="fig-vm-pic106">
<a class="reference internal image-reference" href="../_images/virt-mem-pic106.png"><img alt="../_images/virt-mem-pic106.png" src="../_images/virt-mem-pic106.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.4 </span><span class="caption-text">Page table entry with D (dirty) bit</span><a class="headerlink" href="#fig-vm-pic106" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="paging-avoiding-fragmentation">
<h2><span class="section-number">14.2.3. </span>Paging - Avoiding Fragmentation<a class="headerlink" href="#paging-avoiding-fragmentation" title="Link to this heading">#</a></h2>
<p>The fragmentation in <a class="reference internal" href="phys-and-seg.html#mm-virt-mem-frag-4"><span class="std std-numref">Fig. 13.13</span></a> is termed <em>external fragmentation</em>, because the
memory wasted is <em>external</em> to the regions allocated. This situation can
be avoided by <em>compacting</em> memory—moving existing allocations around,
thereby consolidating multiple blocks of free memory into a single large
chunk. This is a slow process, requiring processes to be paused, large
amounts of memory to be copied, and base+bounds registers modified to
point to new locations[^2].</p>
<figure class="align-default" id="fig-vm-fig3">
<a class="reference internal image-reference" href="../_images/virt-mem-map.png"><img alt="../_images/virt-mem-map.png" src="../_images/virt-mem-map.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.5 </span><span class="caption-text">A mapping between virtual pages and physical pages</span><a class="headerlink" href="#fig-vm-fig3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Instead, modern CPUs use <em>paged address translation</em>, which divides the
physical and virtual memory spaces into fixed-sized pages, typically
4KB, and provides a flexible mapping between virtual and physical pages,
as shown in <a class="reference internal" href="#fig-vm-fig3"><span class="std std-numref">Fig. 14.5</span></a>. The operating system can then maintain a list
of free physical pages, and allocate them as needed. Because any
combination of physical pages may be used for an allocation request,
there is no external fragmentation, and a request will not fail as long
as there are enough free physical pages to fulfill it.</p>
<section id="internal-fragmentation">
<h3><span class="section-number">14.2.3.1. </span>Internal Fragmentation<a class="headerlink" href="#internal-fragmentation" title="Link to this heading">#</a></h3>
<p>Paging solves the problem of external fragmentation, there is no wasted space between pages of virtual memory.  However, paging does suffer from
another issue, <em>internal fragmentation</em>, space may be wasted
<em>inside</em> the allocated pages. E.g. if 10 KB of memory is allocated in
4KB pages, 3 pages (a total of 12 KB) are allocated, and 2KB is wasted.
To allocate hundreds of KB in pages of 4KB this is a minor overhead:
about <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> a page, or 2 KB, wasted per allocation. But internal
fragmentation makes this approach inefficient for very small allocations
(e.g. the <code class="docutils literal notranslate"><span class="pre">new</span></code> operator in C++), as shown in <a class="reference internal" href="#fig-vm-fig4"><span class="std std-numref">Fig. 14.6</span></a>.
(It is also one reason why even though most
CPUs support multi-megabyte or even multi-gigabyte “huge” pages, which
are slightly more efficient than 4 KB pages, they are rarely used.)</p>
<figure class="align-default" id="fig-vm-fig4">
<a class="reference internal image-reference" href="../_images/virt-mem-pic7.png"><img alt="../_images/virt-mem-pic7.png" src="../_images/virt-mem-pic7.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.6 </span><span class="caption-text">Example of internal fragmentation</span><a class="headerlink" href="#fig-vm-fig4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./mm"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="vmabs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">14.1. </span>Abstracting a useful interface for memory management.</p>
      </div>
    </a>
    <a class="right-next"
       href="page-tables.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14.3. </span>Page Tables</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paged-address-translation">14.2.1. Paged Address Translation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-virtual-address-space-with-paging">14.2.1.1. The virtual address space with Paging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mmu-memory-management-unit">14.2.2. MMU Memory Management Unit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-over-commitment-and-paging">14.2.2.1. Memory Over-Commitment and Paging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#paging-avoiding-fragmentation">14.2.3. Paging - Avoiding Fragmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-fragmentation">14.2.3.1. Internal Fragmentation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By (see contributing chapter book)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>